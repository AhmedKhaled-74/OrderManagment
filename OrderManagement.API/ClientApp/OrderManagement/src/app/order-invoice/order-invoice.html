<div class="container py-4" *ngIf="order$ | async as order">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">Invoice #{{ order.orderNumber }}</h2>
    <div class="text-end text-muted">
      {{ order.orderDate | date : "yyyy-MM-dd hh:mm a" }}
    </div>
  </div>

  <div class="card shadow-sm rounded-4">
    <div class="card-body p-4">
      <div class="mb-4">
        <h5 class="fw-bold">Customer</h5>
        <p class="mb-0">{{ order.customerName }}</p>
      </div>

      <div class="table-responsive">
        <table class="table table-striped align-middle">
          <thead class="table-light">
            <tr>
              <th scope="col">Item</th>
              <th scope="col" class="text-end">Quantity</th>
              <th scope="col" class="text-end">Unit Price</th>
              <th scope="col" class="text-end">Total</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of order.orderItems">
              <td>{{ item.itemName }}</td>
              <td class="text-end">{{ item.quantity }}</td>
              <td class="text-end">${{ item.quantity | number : "1.2-2" }}</td>
              <td class="text-end">
                ${{ item.quantity * item.unitPrice | number : "1.2-2" }}
              </td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <td colspan="3" class="text-end fw-bold">Subtotal:</td>
              <td class="text-end fw-bold">
                ${{ order.totalAmount | number : "1.2-2" }}
              </td>
            </tr>
          </tfoot>
        </table>
      </div>

      <div class="mt-4 d-flex gap-3 justify-content-end align-items-center">
        <button class="btn btn-outline-secondary" (click)="goBack()">
          <fa-icon [icon]="faArrowLeft"></fa-icon> Back to Orders
        </button>
        <button class="btn btn-outline-primary" (click)="printOrder(order)">
          <fa-icon [icon]="faPrint"></fa-icon> Print Order
        </button>
        <!-- Delete Order Button -->
        <button
          class="btn btn-outline-danger"
          data-bs-toggle="modal"
          data-bs-target="#deleteConfirmModal"
        >
          <fa-icon [icon]="faDeleteLeft"></fa-icon> Delete Order
        </button>
      </div>
    </div>
  </div>
  <div
    *ngIf="deleteError"
    class="alert alert-danger text-center mt-2"
    role="alert"
  >
    <i class="bi bi-x-circle-fill me-2"></i> Order deletion failed. Please try
    again.
  </div>
  <!-- Confirmation Modal -->
  <div
    class="modal fade"
    id="deleteConfirmModal"
    tabindex="-1"
    aria-labelledby="deleteConfirmModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content shadow-sm rounded-4">
        <div class="modal-header border-0">
          <h5 class="modal-title text-danger" id="deleteConfirmModalLabel">
            <i class="bi bi-exclamation-triangle me-2"></i> Confirm Deletion
          </h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body text-center">
          <p class="mb-3 fs-5">Are you sure you want to delete this order?</p>
        </div>
        <div class="modal-footer border-0 d-flex justify-content-between">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Cancel
          </button>
          <button
            type="button"
            class="btn btn-danger"
            (click)="confirmDelete()"
          >
            <fa-icon [icon]="faTrashAlt" class="me-1"></fa-icon> Delete
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
